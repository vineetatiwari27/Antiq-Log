{"ast":null,"code":"import _taggedTemplateLiteral from \"C:\\\\Users\\\\vinee\\\\vsfiles\\\\Comfy Sloth\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\vinee\\\\vsfiles\\\\Comfy Sloth\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\vinee\\\\vsfiles\\\\Comfy Sloth\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\vinee\\\\vsfiles\\\\Comfy Sloth\\\\src\\\\components\\\\StripeCheckout.js\",\n    _templateObject;\n\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, $Symbol = \"function\" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || \"@@iterator\", asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\", toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, \"\"); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return generator._invoke = function (innerFn, self, context) { var state = \"suspendedStart\"; return function (method, arg) { if (\"executing\" === state) throw new Error(\"Generator is already running\"); if (\"completed\" === state) { if (\"throw\" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) { if (\"suspendedStart\" === state) throw state = \"completed\", context.arg; context.dispatchException(context.arg); } else \"return\" === context.method && context.abrupt(\"return\", context.arg); state = \"executing\"; var record = tryCatch(innerFn, self, context); if (\"normal\" === record.type) { if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg); } }; }(innerFn, self, context), generator; } function tryCatch(fn, obj, arg) { try { return { type: \"normal\", arg: fn.call(obj, arg) }; } catch (err) { return { type: \"throw\", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { [\"next\", \"throw\", \"return\"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if (\"throw\" !== record.type) { var result = record.arg, value = result.value; return value && \"object\" == typeof value && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke(\"next\", value, resolve, reject); }, function (err) { invoke(\"throw\", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke(\"throw\", error, resolve, reject); }); } reject(record.arg); } var previousPromise; this._invoke = function (method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); }; } function maybeInvokeDelegate(delegate, context) { var method = delegate.iterator[context.method]; if (undefined === method) { if (context.delegate = null, \"throw\" === context.method) { if (delegate.iterator.return && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel; context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\"); } return ContinueSentinel; } var record = tryCatch(method, delegate.iterator, context.arg); if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = \"normal\", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: \"root\" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if (\"function\" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) { if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; } return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, \"constructor\", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) { var ctor = \"function\" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, \"toString\", function () { return \"[object Generator]\"; }), exports.keys = function (object) { var keys = []; for (var key in object) { keys.push(key); } return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) { \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); } }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if (\"throw\" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if (\"root\" === entry.tryLoc) return handle(\"end\"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, \"catchLoc\"), hasFinally = hasOwn.call(entry, \"finallyLoc\"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error(\"try statement without catch or finally\"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if (\"throw\" === record.type) throw record.arg; return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if (\"throw\" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }\n\nimport React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { CardElement, useStripe, Elements, useElements } from '@stripe/react-stripe-js';\nimport axios from 'axios';\nimport { useCartContext } from '../context/cart_context';\nimport { useUserContext } from '../context/user_context';\nimport { formatPrice } from '../utils/helpers';\nimport { useNavigate } from 'react-router-dom';\nvar promise = loadStripe(process.env.REACT_APP_STRIPE_PUBLIC_KEY);\n\nvar CheckoutForm = function CheckoutForm() {\n  var _useCartContext = useCartContext(),\n      cart = _useCartContext.cart,\n      total_amount = _useCartContext.total_amount,\n      shipping_fee = _useCartContext.shipping_fee,\n      clearCart = _useCartContext.clearCart;\n\n  var _useUserContext = useUserContext(),\n      myUser = _useUserContext.myUser;\n\n  var navigate = useNavigate();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      succeeded = _useState2[0],\n      setSucceeded = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      processing = _useState6[0],\n      setProcessing = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      disabled = _useState8[0],\n      setDisabled = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      clientSecret = _useState10[0],\n      setClientSecret = _useState10[1];\n\n  var stripe = useStripe();\n  var elements = useElements();\n\n  var createPaymentIntent = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var _yield$axios$post, data;\n\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.post('/.netlify/functions/create-payment-intent', JSON.stringify({\n                cart: cart,\n                shipping_fee: shipping_fee,\n                total_amount: total_amount\n              }));\n\n            case 3:\n              _yield$axios$post = _context.sent;\n              data = _yield$axios$post.data;\n              setClientSecret(data.clientSecret);\n              _context.next = 10;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 8]]);\n    }));\n\n    return function createPaymentIntent() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    createPaymentIntent(); // eslint-disable-next-line\n  }, []);\n  var cardStyle = {\n    style: {\n      base: {\n        color: '#32325d',\n        fontFamily: 'Arial, sans-serif',\n        fontSmoothing: 'antialiased',\n        fontSize: '16px',\n        '::placeholder': {\n          color: '#32325d'\n        }\n      },\n      invalid: {\n        color: '#fa755a',\n        iconColor: '#fa755a'\n      }\n    }\n  };\n\n  var handleChange = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event) {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              // Listen for changes in the CardElement\n              // and display any errors as the customer types their card details\n              setDisabled(event.empty);\n              setError(event.error ? event.error.message : '');\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleChange(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(ev) {\n      var payload;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              ev.preventDefault();\n              setProcessing(true);\n              _context3.next = 4;\n              return stripe.confirmCardPayment(clientSecret, {\n                payment_method: {\n                  card: elements.getElement(CardElement)\n                }\n              });\n\n            case 4:\n              payload = _context3.sent;\n\n              if (payload.error) {\n                setError(\"Payment failed \".concat(payload.error.message));\n                setProcessing(false);\n              } else {\n                setError(null);\n                setProcessing(false);\n                setSucceeded(true);\n                setTimeout(function () {\n                  clearCart();\n                  navigate('/');\n                }, 10000);\n              }\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleSubmit(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 5\n    }\n  }, succeeded ? /*#__PURE__*/React.createElement(\"article\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }, \"Thank you\"), /*#__PURE__*/React.createElement(\"h4\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, \"Your payment was successful!\"), /*#__PURE__*/React.createElement(\"h4\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, \"Redirecting to home page shortly\")) : /*#__PURE__*/React.createElement(\"article\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, \"Hello, \", myUser && myUser.name), /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 11\n    }\n  }, \"Your total is \", formatPrice(total_amount)), /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }, \"Test Card Number: 4242 4242 4242 4242\")), /*#__PURE__*/React.createElement(\"form\", {\n    id: \"payment-form\",\n    onSubmit: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CardElement, {\n    id: \"card-element\",\n    options: cardStyle,\n    onChange: handleChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    disabled: processing || disabled || succeeded,\n    id: \"submit\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    id: \"button-text\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }\n  }, processing ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"spinner\",\n    id: \"spinner\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 27\n    }\n  }) : 'Pay')), error && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-error\",\n    role: \"alert\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, error), /*#__PURE__*/React.createElement(\"p\", {\n    className: succeeded ? 'result-message' : 'result-message hidden',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, \"Payment succeeded, see the result in your\", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"https://dashboard.stripe.com/test/payments\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 11\n    }\n  }, ' ', \"Stripe dashboard.\"), ' ', \"Refresh the page to pay again.\")));\n};\n\nvar StripeCheckout = function StripeCheckout() {\n  return /*#__PURE__*/React.createElement(Wrapper, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Elements, {\n    stripe: promise,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CheckoutForm, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 9\n    }\n  })));\n};\n\nvar Wrapper = styled.section(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  form {\\n    width: 30vw;\\n    align-self: center;\\n    box-shadow: 0px 0px 0px 0.5px rgba(50, 50, 93, 0.1),\\n      0px 2px 5px 0px rgba(50, 50, 93, 0.1),\\n      0px 1px 1.5px 0px rgba(0, 0, 0, 0.07);\\n    border-radius: 7px;\\n    padding: 40px;\\n  }\\n  input {\\n    border-radius: 6px;\\n    margin-bottom: 6px;\\n    padding: 12px;\\n    border: 1px solid rgba(50, 50, 93, 0.1);\\n    max-height: 44px;\\n    font-size: 16px;\\n    width: 100%;\\n    background: white;\\n    box-sizing: border-box;\\n  }\\n  .result-message {\\n    line-height: 22px;\\n    font-size: 16px;\\n  }\\n  .result-message a {\\n    color: rgb(89, 111, 214);\\n    font-weight: 600;\\n    text-decoration: none;\\n  }\\n  .hidden {\\n    display: none;\\n  }\\n  #card-error {\\n    color: rgb(105, 115, 134);\\n    font-size: 16px;\\n    line-height: 20px;\\n    margin-top: 12px;\\n    text-align: center;\\n  }\\n  #card-element {\\n    border-radius: 4px 4px 0 0;\\n    padding: 12px;\\n    border: 1px solid rgba(50, 50, 93, 0.1);\\n    max-height: 44px;\\n    width: 100%;\\n    background: white;\\n    box-sizing: border-box;\\n  }\\n  #payment-request-button {\\n    margin-bottom: 32px;\\n  }\\n  /* Buttons and links */\\n  button {\\n    background: #5469d4;\\n    font-family: Arial, sans-serif;\\n    color: #ffffff;\\n    border-radius: 0 0 4px 4px;\\n    border: 0;\\n    padding: 12px 16px;\\n    font-size: 16px;\\n    font-weight: 600;\\n    cursor: pointer;\\n    display: block;\\n    transition: all 0.2s ease;\\n    box-shadow: 0px 4px 5.5px 0px rgba(0, 0, 0, 0.07);\\n    width: 100%;\\n  }\\n  button:hover {\\n    filter: contrast(115%);\\n  }\\n  button:disabled {\\n    opacity: 0.5;\\n    cursor: default;\\n  }\\n  /* spinner/processing state, errors */\\n  .spinner,\\n  .spinner:before,\\n  .spinner:after {\\n    border-radius: 50%;\\n  }\\n  .spinner {\\n    color: #ffffff;\\n    font-size: 22px;\\n    text-indent: -99999px;\\n    margin: 0px auto;\\n    position: relative;\\n    width: 20px;\\n    height: 20px;\\n    box-shadow: inset 0 0 0 2px;\\n    -webkit-transform: translateZ(0);\\n    -ms-transform: translateZ(0);\\n    transform: translateZ(0);\\n  }\\n  .spinner:before,\\n  .spinner:after {\\n    position: absolute;\\n    content: '';\\n  }\\n  .spinner:before {\\n    width: 10.4px;\\n    height: 20.4px;\\n    background: #5469d4;\\n    border-radius: 20.4px 0 0 20.4px;\\n    top: -0.2px;\\n    left: -0.2px;\\n    -webkit-transform-origin: 10.4px 10.2px;\\n    transform-origin: 10.4px 10.2px;\\n    -webkit-animation: loading 2s infinite ease 1.5s;\\n    animation: loading 2s infinite ease 1.5s;\\n  }\\n  .spinner:after {\\n    width: 10.4px;\\n    height: 10.2px;\\n    background: #5469d4;\\n    border-radius: 0 10.2px 10.2px 0;\\n    top: -0.1px;\\n    left: 10.2px;\\n    -webkit-transform-origin: 0px 10.2px;\\n    transform-origin: 0px 10.2px;\\n    -webkit-animation: loading 2s infinite ease;\\n    animation: loading 2s infinite ease;\\n  }\\n  @keyframes loading {\\n    0% {\\n      -webkit-transform: rotate(0deg);\\n      transform: rotate(0deg);\\n    }\\n    100% {\\n      -webkit-transform: rotate(360deg);\\n      transform: rotate(360deg);\\n    }\\n  }\\n  @media only screen and (max-width: 600px) {\\n    form {\\n      width: 80vw;\\n    }\\n  }\\n\"])));\nexport default StripeCheckout;","map":{"version":3,"names":["React","useState","useEffect","styled","loadStripe","CardElement","useStripe","Elements","useElements","axios","useCartContext","useUserContext","formatPrice","useNavigate","promise","process","env","REACT_APP_STRIPE_PUBLIC_KEY","CheckoutForm","cart","total_amount","shipping_fee","clearCart","myUser","navigate","succeeded","setSucceeded","error","setError","processing","setProcessing","disabled","setDisabled","clientSecret","setClientSecret","stripe","elements","createPaymentIntent","post","JSON","stringify","data","cardStyle","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","handleChange","event","empty","message","handleSubmit","ev","preventDefault","confirmCardPayment","payment_method","card","getElement","payload","setTimeout","name","StripeCheckout","Wrapper","section"],"sources":["C:/Users/vinee/vsfiles/Comfy Sloth/src/components/StripeCheckout.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport styled from 'styled-components';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\nimport {\r\n  CardElement,\r\n  useStripe,\r\n  Elements,\r\n  useElements,\r\n} from '@stripe/react-stripe-js';\r\nimport axios from 'axios';\r\nimport { useCartContext } from '../context/cart_context';\r\nimport { useUserContext } from '../context/user_context';\r\nimport { formatPrice } from '../utils/helpers';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst promise = loadStripe(process.env.REACT_APP_STRIPE_PUBLIC_KEY);\r\n\r\nconst CheckoutForm = () => {\r\n  const { cart, total_amount, shipping_fee, clearCart } = useCartContext();\r\n  const { myUser } = useUserContext();\r\n  const navigate = useNavigate();\r\n  const [succeeded, setSucceeded] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [processing, setProcessing] = useState('');\r\n  const [disabled, setDisabled] = useState(true);\r\n  const [clientSecret, setClientSecret] = useState('');\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n\r\n  const createPaymentIntent = async () => {\r\n    try {\r\n      const { data } = await axios.post(\r\n        '/.netlify/functions/create-payment-intent',\r\n\r\n        JSON.stringify({ cart, shipping_fee, total_amount })\r\n      );\r\n      setClientSecret(data.clientSecret);\r\n    } catch (error) {\r\n      // console.log(error.response)\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    createPaymentIntent();\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  const cardStyle = {\r\n    style: {\r\n      base: {\r\n        color: '#32325d',\r\n        fontFamily: 'Arial, sans-serif',\r\n        fontSmoothing: 'antialiased',\r\n        fontSize: '16px',\r\n        '::placeholder': {\r\n          color: '#32325d',\r\n        },\r\n      },\r\n      invalid: {\r\n        color: '#fa755a',\r\n        iconColor: '#fa755a',\r\n      },\r\n    },\r\n  };\r\n  const handleChange = async (event) => {\r\n    // Listen for changes in the CardElement\r\n    // and display any errors as the customer types their card details\r\n    setDisabled(event.empty);\r\n    setError(event.error ? event.error.message : '');\r\n  };\r\n  const handleSubmit = async (ev) => {\r\n    ev.preventDefault();\r\n    setProcessing(true);\r\n    const payload = await stripe.confirmCardPayment(clientSecret, {\r\n      payment_method: {\r\n        card: elements.getElement(CardElement),\r\n      },\r\n    });\r\n    if (payload.error) {\r\n      setError(`Payment failed ${payload.error.message}`);\r\n      setProcessing(false);\r\n    } else {\r\n      setError(null);\r\n      setProcessing(false);\r\n      setSucceeded(true);\r\n      setTimeout(() => {\r\n        clearCart();\r\n        navigate('/');\r\n      }, 10000);\r\n    }\r\n  };\r\n  return (\r\n    <div>\r\n      {succeeded ? (\r\n        <article>\r\n          <h4>Thank you</h4>\r\n          <h4>Your payment was successful!</h4>\r\n          <h4>Redirecting to home page shortly</h4>\r\n        </article>\r\n      ) : (\r\n        <article>\r\n          <h4>Hello, {myUser && myUser.name}</h4>\r\n          <p>Your total is {formatPrice(total_amount)}</p>\r\n          <p>Test Card Number: 4242 4242 4242 4242</p>\r\n        </article>\r\n      )}\r\n      <form id='payment-form' onSubmit={handleSubmit}>\r\n        <CardElement\r\n          id='card-element'\r\n          options={cardStyle}\r\n          onChange={handleChange}\r\n        />\r\n        <button disabled={processing || disabled || succeeded} id='submit'>\r\n          <span id='button-text'>\r\n            {processing ? <div className='spinner' id='spinner'></div> : 'Pay'}\r\n          </span>\r\n        </button>\r\n        {/* Show any error that happens when processing the payment */}\r\n        {error && (\r\n          <div className='card-error' role='alert'>\r\n            {error}\r\n          </div>\r\n        )}\r\n        {/* Show a success message upon completion */}\r\n        <p className={succeeded ? 'result-message' : 'result-message hidden'}>\r\n          Payment succeeded, see the result in your\r\n          <a href={`https://dashboard.stripe.com/test/payments`}>\r\n            {' '}\r\n            Stripe dashboard.\r\n          </a>{' '}\r\n          Refresh the page to pay again.\r\n        </p>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst StripeCheckout = () => {\r\n  return (\r\n    <Wrapper>\r\n      <Elements stripe={promise}>\r\n        <CheckoutForm />\r\n      </Elements>\r\n    </Wrapper>\r\n  );\r\n};\r\n\r\nconst Wrapper = styled.section`\r\n  form {\r\n    width: 30vw;\r\n    align-self: center;\r\n    box-shadow: 0px 0px 0px 0.5px rgba(50, 50, 93, 0.1),\r\n      0px 2px 5px 0px rgba(50, 50, 93, 0.1),\r\n      0px 1px 1.5px 0px rgba(0, 0, 0, 0.07);\r\n    border-radius: 7px;\r\n    padding: 40px;\r\n  }\r\n  input {\r\n    border-radius: 6px;\r\n    margin-bottom: 6px;\r\n    padding: 12px;\r\n    border: 1px solid rgba(50, 50, 93, 0.1);\r\n    max-height: 44px;\r\n    font-size: 16px;\r\n    width: 100%;\r\n    background: white;\r\n    box-sizing: border-box;\r\n  }\r\n  .result-message {\r\n    line-height: 22px;\r\n    font-size: 16px;\r\n  }\r\n  .result-message a {\r\n    color: rgb(89, 111, 214);\r\n    font-weight: 600;\r\n    text-decoration: none;\r\n  }\r\n  .hidden {\r\n    display: none;\r\n  }\r\n  #card-error {\r\n    color: rgb(105, 115, 134);\r\n    font-size: 16px;\r\n    line-height: 20px;\r\n    margin-top: 12px;\r\n    text-align: center;\r\n  }\r\n  #card-element {\r\n    border-radius: 4px 4px 0 0;\r\n    padding: 12px;\r\n    border: 1px solid rgba(50, 50, 93, 0.1);\r\n    max-height: 44px;\r\n    width: 100%;\r\n    background: white;\r\n    box-sizing: border-box;\r\n  }\r\n  #payment-request-button {\r\n    margin-bottom: 32px;\r\n  }\r\n  /* Buttons and links */\r\n  button {\r\n    background: #5469d4;\r\n    font-family: Arial, sans-serif;\r\n    color: #ffffff;\r\n    border-radius: 0 0 4px 4px;\r\n    border: 0;\r\n    padding: 12px 16px;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    cursor: pointer;\r\n    display: block;\r\n    transition: all 0.2s ease;\r\n    box-shadow: 0px 4px 5.5px 0px rgba(0, 0, 0, 0.07);\r\n    width: 100%;\r\n  }\r\n  button:hover {\r\n    filter: contrast(115%);\r\n  }\r\n  button:disabled {\r\n    opacity: 0.5;\r\n    cursor: default;\r\n  }\r\n  /* spinner/processing state, errors */\r\n  .spinner,\r\n  .spinner:before,\r\n  .spinner:after {\r\n    border-radius: 50%;\r\n  }\r\n  .spinner {\r\n    color: #ffffff;\r\n    font-size: 22px;\r\n    text-indent: -99999px;\r\n    margin: 0px auto;\r\n    position: relative;\r\n    width: 20px;\r\n    height: 20px;\r\n    box-shadow: inset 0 0 0 2px;\r\n    -webkit-transform: translateZ(0);\r\n    -ms-transform: translateZ(0);\r\n    transform: translateZ(0);\r\n  }\r\n  .spinner:before,\r\n  .spinner:after {\r\n    position: absolute;\r\n    content: '';\r\n  }\r\n  .spinner:before {\r\n    width: 10.4px;\r\n    height: 20.4px;\r\n    background: #5469d4;\r\n    border-radius: 20.4px 0 0 20.4px;\r\n    top: -0.2px;\r\n    left: -0.2px;\r\n    -webkit-transform-origin: 10.4px 10.2px;\r\n    transform-origin: 10.4px 10.2px;\r\n    -webkit-animation: loading 2s infinite ease 1.5s;\r\n    animation: loading 2s infinite ease 1.5s;\r\n  }\r\n  .spinner:after {\r\n    width: 10.4px;\r\n    height: 10.2px;\r\n    background: #5469d4;\r\n    border-radius: 0 10.2px 10.2px 0;\r\n    top: -0.1px;\r\n    left: 10.2px;\r\n    -webkit-transform-origin: 0px 10.2px;\r\n    transform-origin: 0px 10.2px;\r\n    -webkit-animation: loading 2s infinite ease;\r\n    animation: loading 2s infinite ease;\r\n  }\r\n  @keyframes loading {\r\n    0% {\r\n      -webkit-transform: rotate(0deg);\r\n      transform: rotate(0deg);\r\n    }\r\n    100% {\r\n      -webkit-transform: rotate(360deg);\r\n      transform: rotate(360deg);\r\n    }\r\n  }\r\n  @media only screen and (max-width: 600px) {\r\n    form {\r\n      width: 80vw;\r\n    }\r\n  }\r\n`;\r\n\r\nexport default StripeCheckout;"],"mappings":"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"},"metadata":{},"sourceType":"module"}